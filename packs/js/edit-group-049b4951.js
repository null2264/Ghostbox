import{bj as Y,kN as ee,bl as ae,bm as te,r as p,u as re,t as se,e9 as oe,au as F,q as ne,a,aC as ie,bE as ue,R as v,aw as g,bF as C,F as f,bG as de,A as le,dc as pe,bZ as ce,bI as me,ab as ve,X as ge,f2 as fe,f3 as he,o as _e,aQ as be,bp as k,bL as H}from"../index-180a7f7a.js";import"./es.array.splice-be37e5fb.js";import{u as Se}from"./useGroupTags-1276006d.js";import{u as L}from"./useImageField-f742c22c.js";import{H as Ge,A as xe}from"./header-picker-3b65d391.js";import{G as ye}from"./group-tags-field-76577b7d.js";import"./photo-plus-14444f2c.js";import"./streamfield-642350d6.js";function Te(s){const t=Y(),{createEntity:o,...n}=ee([te.GROUPS],i=>t.put(`/api/v1/groups/${s}`,i,{headers:{"Content-Type":"multipart/form-data"}}),{schema:ae});return{updateGroup:o,...n}}function $(s){const[t,o]=p.useState(s),n=typeof s=="string",i=d=>{o(d.target.value)};return p.useEffect(()=>{n&&o(s)},[n]),{value:t||"",onChange:i}}var Ee=function(t){return t&&fe(t)?void 0:t},Ae=function(t){return t&&he(t)?void 0:t},h=_e({heading:{id:"navigation_bar.edit_group",defaultMessage:"Edit Group"},groupNamePlaceholder:{id:"manage_group.fields.name_placeholder",defaultMessage:"Group Name"},groupDescriptionPlaceholder:{id:"manage_group.fields.description_placeholder",defaultMessage:"Description"},groupSaved:{id:"group.update.success",defaultMessage:"Group successfully saved"}}),Ce=function(t){var o,n,i=t.params.groupId,d=re(),y=se(),T=oe(i),e=T.group,U=T.isLoading,j=Te(i),q=j.updateGroup,B=Se(i),O=B.invalidate,Q=p.useState(!1),E=F(Q,2),_=E[0],A=E[1],W=p.useState([""]),M=F(W,2),c=M[0],m=M[1],b=L({maxPixels:400*400,preview:Ee(e==null?void 0:e.avatar)}),S=L({maxPixels:1920*1080,preview:Ae(e==null?void 0:e.header)}),I=$(e==null?void 0:e.display_name),N=$(e==null?void 0:e.note_plain),X=Number(y.configuration.groups.max_characters_name),Z=Number(y.configuration.groups.max_characters_description),R=(o=(n=ne(function(r){return r.instance.configuration.media_attachments.supported_mime_types}))===null||n===void 0?void 0:n.filter(function(r){return r.startsWith("image/")}).join(","))!==null&&o!==void 0?o:"";function z(){return G.apply(this,arguments)}function G(){return G=be(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return A(!0),u.next=3,q({display_name:I.value,note:N.value,avatar:b.file===null?"":b.file,header:S.file===null?"":S.file,tags:c},{onSuccess:function(){O(),k.success(d.formatMessage(h.groupSaved))},onError:function(P){var l,x,w=(l=P.response)===null||l===void 0||(l=l.data)===null||l===void 0?void 0:l.error;((x=P.response)===null||x===void 0?void 0:x.status)===422&&typeof w<"u"&&k.error(w)}});case 3:A(!1);case 4:case"end":return u.stop()}},r)})),G.apply(this,arguments)}var J=function(){m([].concat(H(c),[""]))},K=function(D){var u=H(c);u.splice(D,1),m(u)};return p.useEffect(function(){e&&m(e.tags.map(function(r){return r.name}))},[e==null?void 0:e.id]),U?a(ie,{}):a(ge,{label:d.formatMessage(h.heading)},void 0,a(ue,{onSubmit:z},void 0,a("div",{className:"relative mb-12 flex"},void 0,v.createElement(Ge,g({accept:R,disabled:_},S)),v.createElement(xe,g({accept:R,disabled:_},b))),a(C,{labelText:a(f,{id:"manage_group.fields.name_label_optional",defaultMessage:"Group name"}),hintText:a(f,{id:"manage_group.fields.cannot_change_hint",defaultMessage:"This cannot be changed after the group is created."})},void 0,v.createElement(de,g({type:"text",placeholder:d.formatMessage(h.groupNamePlaceholder),maxLength:X},I,{append:a(le,{className:"h-5 w-5 text-gray-600",src:pe}),disabled:!0}))),a(C,{labelText:a(f,{id:"manage_group.fields.description_label",defaultMessage:"Description"})},void 0,v.createElement(ce,g({autoComplete:"off",placeholder:d.formatMessage(h.groupDescriptionPlaceholder),maxLength:Z},N))),a("div",{className:"pb-6"},void 0,a(ye,{tags:c,onChange:m,onAddItem:J,onRemoveItem:K})),a(me,{},void 0,a(ve,{theme:"primary",type:"submit",disabled:_,block:!0},void 0,a(f,{id:"edit_profile.save",defaultMessage:"Save"})))))};export{Ce as default};
