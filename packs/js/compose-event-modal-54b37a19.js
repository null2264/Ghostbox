import{q as l,a as e,a3 as N,y as k,A as ie,H as I,hE as oe,u as V,d as W,r as T,a8 as B,ax as U,cl as pe,jF as ge,I as K,aB as fe,W as $,jG as he,o as se,R as G,F as o,jH as _e,bH as R,b_ as Ce,bI as Me,aK as J,a6 as Q,bG as be,hM as X,j0 as Y,al as Z,aF as Ee,bw as Te,ae as ee,B as ye,jI as Se,jJ as ke,jK as xe,jL as Re,jM as Ie,jN as je,jO as we,aH as Ne,aL as Pe,bx as qe,ef as Ae,jP as De,jQ as Fe,jR as Le,T as ze,jS as Be,jT as Oe}from"../index-c4c40436.js";import{v as He}from"./backspace-c284aa0a.js";import{a as Ue}from"./modal-root-eacf89aa.js";import{isCurrentOrFutureDate as te}from"./schedule-form-7af42144.js";import{v as Ke}from"./photo-plus-14444f2c.js";const Ge="/packs/assets/road-3636cb68.svg",Ve="/packs/assets/home-2-1de3a8c6.svg",We="/packs/assets/building-community-2a262560.svg";var O=We,$e=Ve,Je=oe,ae=Ge,re={house:$e,street:ae,secondary:ae,zone:O,city:O,administrative:O},Qe=function(d){var u=d.id,n=l(function(i){return i.locations.get(u)});return n?e(I,{alignItems:"center",space:2},void 0,e(ie,{src:re[n.type]||Je}),e(N,{},void 0,e(k,{},void 0,n.description),e(k,{size:"xs",theme:"muted"},void 0,[n.street,n.locality,n.country].filter(function(i){return i==null?void 0:i.trim()}).join(" · ")))):null},H=function(){},ne=se({placeholder:{id:"location_search.placeholder",defaultMessage:"Find an address"}}),Xe=function(d){var u=d.onSelected,n=V(),i=W(),_=T.useState(B()),m=U(_,2),C=m[0],M=m[1],s=T.useRef(new AbortController),p=T.useState(""),E=U(p,2),x=E[0],w=E[1],y=function(){return!(x.length>0)},P=function(f){var r=f.target;A(),F(r.value),w(r.value)},b=function(f,r,S){typeof S=="string"&&u(S)},v=function(f){f.preventDefault(),y()||w("")},q=function(f){if(f.key==="Escape"){var r;(r=document.querySelector(".ui"))===null||r===void 0||(r=r.parentElement)===null||r===void 0||r.focus()}},A=function(){s.current.abort(),s.current=new AbortController},D=function(){M(B())},F=T.useCallback(pe(function(g){i(ge(g,s.current.signal)).then(function(f){var r=f.map(function(S){return S.origin_id});M(B(r))}).catch(H)},900,{leading:!0,trailing:!0}),[]);return T.useEffect(function(){x===""&&D()},[x]),e("div",{className:"search"},void 0,e(he,{className:"rounded-full",placeholder:n.formatMessage(ne.placeholder),value:x,onChange:P,suggestions:C.toList(),onSuggestionsFetchRequested:H,onSuggestionsClearRequested:H,onSuggestionSelected:b,searchTokens:[],onKeyDown:q,renderSuggestion:Qe}),e("div",{role:"button",tabIndex:0,className:"search__icon",onClick:v},void 0,e(K,{src:fe,className:$("svg-icon--search",{active:y()})}),e(K,{src:He,className:$("svg-icon--backspace",{active:!y()}),"aria-label":n.formatMessage(ne.placeholder)})))},Ye=function(d){var u,n=d.disabled,i=d.onSelectFile,_=T.useRef(null),m=(u=l(function(s){return s.instance.configuration.media_attachments.supported_mime_types}))===null||u===void 0?void 0:u.filter(function(s){return s.startsWith("image/")}),C=function(p){var E;(E=p.target.files)!==null&&E!==void 0&&E.length&&i(p.target.files)},M=function(){var p;(p=_.current)===null||p===void 0||p.click()};return e(I,{className:"h-full w-full cursor-pointer text-primary-500 dark:text-accent-blue",space:3,alignItems:"center",justifyContent:"center",element:"label"},void 0,e(K,{src:Ke,className:"h-7 w-7",onClick:M}),e(k,{size:"sm",theme:"primary",weight:"semibold",transform:"uppercase",tabIndex:0},void 0,e(o,{id:"compose_event.upload_banner",defaultMessage:"Upload photo"})),G.createElement("input",{ref:_,type:"file",accept:m&&m.join(","),onChange:C,disabled:n,className:"hidden"}))},h=se({eventNamePlaceholder:{id:"compose_event.fields.name_placeholder",defaultMessage:"Name"},eventDescriptionPlaceholder:{id:"compose_event.fields.description_placeholder",defaultMessage:"Description"},eventStartTimePlaceholder:{id:"compose_event.fields.start_time_placeholder",defaultMessage:"Event begins on…"},eventEndTimePlaceholder:{id:"compose_event.fields.end_time_placeholder",defaultMessage:"Event ends on…"},resetLocation:{id:"compose_event.reset_location",defaultMessage:"Reset location"},edit:{id:"compose_event.tabs.edit",defaultMessage:"Edit details"},pending:{id:"compose_event.tabs.pending",defaultMessage:"Manage requests"},authorize:{id:"compose_event.participation_requests.authorize",defaultMessage:"Authorize"},reject:{id:"compose_event.participation_requests.reject",defaultMessage:"Reject"},confirm:{id:"confirmations.delete.confirm",defaultMessage:"Delete"},cancelEditing:{id:"confirmations.cancel_editing.confirm",defaultMessage:"Cancel editing"}}),Ze=function(d){var u=d.eventId,n=d.id,i=d.participationMessage,_=V(),m=W(),C=function(){m(Be(u,n))},M=function(){m(Oe(u,n))};return e(ye,{id:n,note:i||void 0,action:e(I,{space:2},void 0,e(ee,{theme:"secondary",size:"sm",text:_.formatMessage(h.authorize),onClick:C}),e(ee,{theme:"danger",size:"sm",text:_.formatMessage(h.reject),onClick:M}))})},st=function(d){var u=d.onClose,n=V(),i=W(),_=T.useState("edit"),m=U(_,2),C=m[0],M=m[1],s=l(function(t){return t.compose_event.banner}),p=l(function(t){return t.compose_event.is_uploading}),E=l(function(t){return t.compose_event.name}),x=l(function(t){return t.compose_event.status}),w=l(function(t){return t.compose_event.start_time}),y=l(function(t){return t.compose_event.end_time}),P=l(function(t){return t.compose_event.approval_required}),b=l(function(t){return t.compose_event.location}),v=l(function(t){return t.compose_event.id}),q=l(function(t){return t.compose_event.is_submitting}),A=function(a){var c=a.target;i(Se(c.value))},D=function(a){var c=a.target;i(ke(c.value))},F=function(a){i(xe(a))},g=function(a){i(Re(a))},f=function(a){var c=a.target;i(Ie(c.checked))},r=function(a){var c=a.target;i(je(c.checked))},S=function(a){i(we(a))},ce=function(){i(function(a,c){Ue(c().compose_event)?a(Ne("CONFIRM",{icon:Pe,heading:v?e(o,{id:"confirmations.cancel_event_editing.heading",defaultMessage:"Cancel event editing"}):e(o,{id:"confirmations.delete_event.heading",defaultMessage:"Delete event"}),message:v?e(o,{id:"confirmations.cancel_event_editing.message",defaultMessage:"Are you sure you want to cancel editing this event? All changes will be lost."}):e(o,{id:"confirmations.delete_event.message",defaultMessage:"Are you sure you want to delete this event?"}),confirm:n.formatMessage(h.confirm),onConfirm:function(){a(qe("COMPOSE_EVENT")),a(Ae())}})):u("COMPOSE_EVENT")})},le=function(a){i(De(a[0],n))},de=function(){i(Fe())},ue=function(){i(Le())},L=l(function(t){var a;return(a=t.user_lists.event_participation_requests.get(v))===null||a===void 0?void 0:a.items});T.useEffect(function(){v&&i(_e(v))},[]);var ve=function(){return b&&e(I,{className:"h-[38px] text-gray-700 dark:text-gray-500",alignItems:"center",space:2},void 0,e(ie,{src:re[b.type]||oe}),e(N,{className:"grow"},void 0,e(k,{},void 0,b.description),e(k,{theme:"muted",size:"xs"},void 0,[b.street,b.locality,b.country].filter(function(a){return a==null?void 0:a.trim()}).join(" · "))),e(J,{title:n.formatMessage(h.resetLocation),src:Q,onClick:function(){return S(null)}}))},me=function(){var a=[{text:n.formatMessage(h.edit),action:function(){return M("edit")},name:"edit"},{text:n.formatMessage(h.pending),action:function(){return M("pending")},name:"pending"}];return e(ze,{items:a,activeItem:C})},z;return C==="edit"?z=e(be,{},void 0,e(R,{labelText:e(o,{id:"compose_event.fields.banner_label",defaultMessage:"Event banner"})},void 0,e("div",{className:"dark:sm:shadow-inset relative flex h-24 items-center justify-center overflow-hidden rounded-lg bg-primary-100 text-primary-500 dark:bg-gray-800 dark:text-white sm:h-32 sm:shadow"},void 0,s?G.createElement(G.Fragment,null,e("img",{className:"h-full w-full object-cover",src:s.url,alt:""}),e(J,{className:"absolute right-2 top-2",src:Q,onClick:de})):e(Ye,{disabled:p,onSelectFile:le}))),e(R,{labelText:e(o,{id:"compose_event.fields.name_label",defaultMessage:"Event name"})},void 0,e(Me,{type:"text",placeholder:n.formatMessage(h.eventNamePlaceholder),value:E,onChange:A})),e(R,{labelText:e(o,{id:"compose_event.fields.description_label",defaultMessage:"Event description"}),hintText:e(o,{id:"compose_event.fields.description_hint",defaultMessage:"Markdown syntax is supported"})},void 0,e(Ce,{autoComplete:"off",placeholder:n.formatMessage(h.eventDescriptionPlaceholder),value:x,onChange:D})),e(R,{labelText:e(o,{id:"compose_event.fields.location_label",defaultMessage:"Event location"})},void 0,b?ve():e(Xe,{onSelected:S})),e(R,{labelText:e(o,{id:"compose_event.fields.start_time_label",defaultMessage:"Event start date"})},void 0,e(X,{fetchComponent:Y},void 0,function(t){return e(t,{showTimeSelect:!0,dateFormat:"MMMM d, yyyy h:mm aa",timeIntervals:15,wrapperClassName:"react-datepicker-wrapper",placeholderText:n.formatMessage(h.eventStartTimePlaceholder),filterDate:te,selected:w,onChange:F})})),e(I,{alignItems:"center",space:2},void 0,e(Z,{checked:!!y,onChange:f}),e(k,{tag:"span",theme:"muted"},void 0,e(o,{id:"compose_event.fields.has_end_time",defaultMessage:"The event has end date"}))),y&&e(R,{labelText:e(o,{id:"compose_event.fields.end_time_label",defaultMessage:"Event end date"})},void 0,e(X,{fetchComponent:Y},void 0,function(t){return e(t,{showTimeSelect:!0,dateFormat:"MMMM d, yyyy h:mm aa",timeIntervals:15,wrapperClassName:"react-datepicker-wrapper",placeholderText:n.formatMessage(h.eventEndTimePlaceholder),filterDate:te,selected:y,onChange:g})})),!v&&e(I,{alignItems:"center",space:2},void 0,e(Z,{checked:P,onChange:r}),e(k,{tag:"span",theme:"muted"},void 0,e(o,{id:"compose_event.fields.approval_required",defaultMessage:"I want to approve participation requests manually"})))):z=L?e(N,{space:3},void 0,L.size>0?L.map(function(t){var a=t.account,c=t.participation_message;return e(Ze,{eventId:v,id:a,participationMessage:c},a)}):e(o,{id:"empty_column.event_participant_requests",defaultMessage:"There are no pending event participation requests."})):e(Ee,{}),e(Te,{title:v?e(o,{id:"navigation_bar.compose_event",defaultMessage:"Manage event"}):e(o,{id:"navigation_bar.create_event",defaultMessage:"Create new event"}),confirmationAction:C==="edit"?ue:void 0,confirmationText:v?e(o,{id:"compose_event.update",defaultMessage:"Update"}):e(o,{id:"compose_event.create",defaultMessage:"Create"}),confirmationDisabled:q,onClose:ce},void 0,e(N,{space:2},void 0,v&&me(),z))};export{st as default};
