import{u as te,a9 as Se,d as Ce,g as ke,r as o,ax as d,bE as Fe,bF as Oe,a as e,aG as je,bG as Ae,bH as Y,bI as ae,bJ as Ee,a3 as Ie,y as C,F as k,aj as Z,ak as h,al as c,bK as Te,ae as Ke,X as Ne,o as Pe,H as $,bL as De,bM as He,br as Re,bN as Ve,_ as re}from"../index-a6716a18.js";import{S as Le}from"./streamfield-06a47221.js";function ee(u,l){var s=Object.keys(u);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(u);l&&(a=a.filter(function(g){return Object.getOwnPropertyDescriptor(u,g).enumerable})),s.push.apply(s,a)}return s}function _(u){for(var l=1;l<arguments.length;l++){var s=arguments[l]!=null?arguments[l]:{};l%2?ee(Object(s),!0).forEach(function(a){re(u,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(s)):ee(Object(s)).forEach(function(a){Object.defineProperty(u,a,Object.getOwnPropertyDescriptor(s,a))})}return u}var i=Pe({subheading_add_new:{id:"column.filters.subheading_add_new",defaultMessage:"Add New Filter"},title:{id:"column.filters.title",defaultMessage:"Title"},keyword:{id:"column.filters.keyword",defaultMessage:"Keyword or phrase"},keywords:{id:"column.filters.keywords",defaultMessage:"Keywords or phrases"},expires:{id:"column.filters.expires",defaultMessage:"Expire after"},home_timeline:{id:"column.filters.home_timeline",defaultMessage:"Home timeline"},public_timeline:{id:"column.filters.public_timeline",defaultMessage:"Public timeline"},notifications:{id:"column.filters.notifications",defaultMessage:"Notifications"},conversations:{id:"column.filters.conversations",defaultMessage:"Conversations"},accounts:{id:"column.filters.accounts",defaultMessage:"Accounts"},drop_header:{id:"column.filters.drop_header",defaultMessage:"Drop instead of hide"},drop_hint:{id:"column.filters.drop_hint",defaultMessage:"Filtered posts will disappear irreversibly, even if filter is later removed"},hide_header:{id:"column.filters.hide_header",defaultMessage:"Hide completely"},hide_hint:{id:"column.filters.hide_hint",defaultMessage:"Completely hide the filtered content, instead of showing a warning"},add_new:{id:"column.filters.add_new",defaultMessage:"Add New Filter"},edit:{id:"column.filters.edit",defaultMessage:"Edit Filter"},create_error:{id:"column.filters.create_error",defaultMessage:"Error adding filter"},expiration_never:{id:"colum.filters.expiration.never",defaultMessage:"Never"},expiration_1800:{id:"colum.filters.expiration.1800",defaultMessage:"30 minutes"},expiration_3600:{id:"colum.filters.expiration.3600",defaultMessage:"1 hour"},expiration_21600:{id:"colum.filters.expiration.21600",defaultMessage:"6 hours"},expiration_43200:{id:"colum.filters.expiration.43200",defaultMessage:"12 hours"},expiration_86400:{id:"colum.filters.expiration.86400",defaultMessage:"1 day"},expiration_604800:{id:"colum.filters.expiration.604800",defaultMessage:"1 week"}}),ze=function(l){var s=l.value,a=l.onChange,g=te(),m=function(w){return function(p){return a(_(_({},s),{},re({},w,p.currentTarget[p.currentTarget.type==="checkbox"?"checked":"value"])))}};return e($,{space:2,grow:!0},void 0,e(ae,{type:"text",outerClassName:"w-2/5 grow",value:s.keyword,onChange:m("keyword"),placeholder:g.formatMessage(i.keyword)}),e($,{alignItems:"center",space:2},void 0,e(c,{checked:s.whole_word,onChange:m("whole_word")}),e(C,{tag:"span",theme:"muted"},void 0,e(k,{id:"column.filters.whole_word",defaultMessage:"Whole word"}))))},qe=function(l){var s=l.params,a=te(),g=Se(),m=Ce(),f=ke(),w=o.useState(!1),p=d(w,2),ie=p[0],F=p[1],se=o.useState(!1),O=d(se,2),ne=O[0],oe=O[1],le=o.useState(""),j=d(le,2),b=j[0],A=j[1],de=o.useState(null),E=d(de,2),I=E[0],ue=E[1],ce=o.useState(!0),T=d(ce,2),K=T[0],N=T[1],fe=o.useState(!1),P=d(fe,2),D=P[0],H=P[1],he=o.useState(!1),R=d(he,2),V=R[0],L=R[1],ge=o.useState(!1),z=d(ge,2),G=z[0],J=z[1],me=o.useState(!1),q=d(me,2),B=q[0],W=q[1],pe=o.useState(!1),X=d(pe,2),M=X[0],Q=X[1],ve=o.useState([{keyword:"",whole_word:!1}]),U=d(ve,2),x=U[0],v=U[1],_e=o.useMemo(function(){return{"":a.formatMessage(i.expiration_never),1800:a.formatMessage(i.expiration_1800),3600:a.formatMessage(i.expiration_3600),21600:a.formatMessage(i.expiration_21600),43200:a.formatMessage(i.expiration_43200),86400:a.formatMessage(i.expiration_86400),604800:a.formatMessage(i.expiration_604800)}},[]),we=function(r){ue(r.target.value)},be=function(r){r.preventDefault();var t=[];K&&t.push("home"),D&&t.push("public"),V&&t.push("notifications"),G&&t.push("thread"),B&&t.push("account"),m(s.id?De(s.id,b,I,t,M,x):He(b,I,t,M,x)).then(function(){g.push("/filters")}).catch(function(){Re.error(a.formatMessage(i.create_error))})},Me=function(r){return v(r)},xe=function(){return v(function(r){return[].concat(Ve(r),[{keyword:"",whole_word:!1}])})},ye=function(r){return v(function(t){return t[r].id?t.map(function(y,S){return S===r?_(_({},y),{},{_destroy:!0}):y}):t.filter(function(y,S){return S!==r})})};return o.useEffect(function(){if(s.id){var n;F(!0),(n=m(Fe(s.id)))===null||n===void 0||n.then(function(r){if(r.filter){var t=Oe(r.filter);A(t.title),N(t.context.includes("home")),H(t.context.includes("public")),L(t.context.includes("notifications")),J(t.context.includes("thread")),W(t.context.includes("account")),Q(t.filter_action==="hide"),v(t.keywords.toJS())}else oe(!0);F(!1)})}},[s.id]),ne?e(je,{}):e(Ne,{className:"filter-settings-panel",label:a.formatMessage(i.subheading_add_new)},void 0,e(Ae,{onSubmit:be},void 0,e(Y,{labelText:a.formatMessage(i.title)},void 0,e(ae,{required:!0,type:"text",name:"title",value:b,onChange:function(r){var t=r.target;return A(t.value)}})),f.filtersExpiration&&e(Y,{labelText:a.formatMessage(i.expires)},void 0,e(Ee,{items:_e,defaultValue:"",onChange:we})),e(Ie,{},void 0,e(C,{size:"sm",weight:"medium"},void 0,e(k,{id:"filters.context_header",defaultMessage:"Filter contexts"})),e(C,{size:"xs",theme:"muted"},void 0,e(k,{id:"filters.context_hint",defaultMessage:"One or multiple contexts where the filter should apply"}))),e(Z,{},void 0,e(h,{label:a.formatMessage(i.home_timeline)},void 0,e(c,{checked:K,onChange:function(r){var t=r.target;return N(t.checked)}})),e(h,{label:a.formatMessage(i.public_timeline)},void 0,e(c,{checked:D,onChange:function(r){var t=r.target;return H(t.checked)}})),e(h,{label:a.formatMessage(i.notifications)},void 0,e(c,{checked:V,onChange:function(r){var t=r.target;return L(t.checked)}})),e(h,{label:a.formatMessage(i.conversations)},void 0,e(c,{checked:G,onChange:function(r){var t=r.target;return J(t.checked)}})),f.filtersV2&&e(h,{label:a.formatMessage(i.accounts)},void 0,e(c,{checked:B,onChange:function(r){var t=r.target;return W(t.checked)}}))),e(Z,{},void 0,e(h,{label:a.formatMessage(f.filtersV2?i.hide_header:i.drop_header),hint:a.formatMessage(f.filtersV2?i.hide_hint:i.drop_hint)},void 0,e(c,{checked:M,onChange:function(r){var t=r.target;return Q(t.checked)}}))),e(Le,{label:a.formatMessage(i.keywords),component:ze,values:x,onChange:Me,onAddItem:xe,onRemoveItem:ye,minItems:1,maxItems:f.filtersV2?1/0:1}),e(Te,{},void 0,e(Ke,{type:"submit",theme:"primary",disabled:ie},void 0,a.formatMessage(s.id?i.edit:i.add_new)))))};export{qe as default};
