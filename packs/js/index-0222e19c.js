import{d as C,az as T,aW as G,q as u,b0 as P,r as L,au as W,b1 as h,a as i,aC as _,X as m,aD as q,F as y,R as B,aE as A}from"../index-f3818f71.js";import{L as x}from"./load-more-d5c5812f.js";import{M as F}from"./media-item-f67b0c3a.js";import"./volume-08f8a8f1.js";import"./es.array.last-index-of-500aeb7b.js";var U=function(n){var c=n.maxId,v=n.onLoadMore,s=function(){v(c)};return i(x,{onClick:s})},K=function(){var n=C(),c=T(),v=c.username,s=G(v,{withRelationship:!0}),e=s.account,I=s.isLoading,$=s.isUnavailable,t=u(function(o){return P(o,e.id)}),l=u(function(o){var a;return(a=o.timelines.get("account:".concat(e==null?void 0:e.id,":media")))===null||a===void 0?void 0:a.isLoading}),f=u(function(o){var a;return(a=o.timelines.get("account:".concat(e==null?void 0:e.id,":media")))===null||a===void 0?void 0:a.hasMore}),w=u(function(o){var a;return(a=o.timelines.get("account:".concat(e==null?void 0:e.id,":media")))===null||a===void 0?void 0:a.next}),E=L.useState(323),p=W(E,2),N=p[0],O=p[1],S=function(a){a&&O(a.offsetWidth)},z=function(){f&&M(t.size>0?t.last().status.id:void 0)},M=function(a){e&&n(h(e.id,{url:w,maxId:a}))},D=function(a){a.preventDefault(),z()},R=function(a){if(a.type==="video")n(A("VIDEO",{media:a,status:a.status,account:a.account}));else{var d=a.status.media_attachments,r=d.findIndex(function(k){return k.id===a.id});n(A("MEDIA",{media:d,index:r,status:a.status}))}};if(L.useEffect(function(){e&&n(h(e.id))},[e==null?void 0:e.id]),I||!t&&l)return i(m,{},void 0,i(_,{}));if(!e)return i(q,{});var g=null;return f&&!(l&&t.size===0)&&(g=i(x,{className:"my-auto",visible:!l,onClick:D})),$?i(m,{},void 0,i("div",{className:"empty-column-indicator"},void 0,i(y,{id:"empty_column.account_unavailable",defaultMessage:"Profile unavailable"}))):i(m,{label:"".concat(e.display_name," (@").concat(e.acct,")"),transparent:!0,withHeader:!1},void 0,B.createElement("div",{role:"feed",className:"flex flex-wrap gap-2",ref:S},t.map(function(o,a){var d,r;return o===null?i(U,{maxId:a>0&&((r=t.get(a-1))===null||r===void 0?void 0:r.id)||null,onLoadMore:M},"more:"+((d=t.get(a+1))===null||d===void 0?void 0:d.id)):i("div",{className:"aspect-square",style:{width:Math.floor((N-4)/3)-4}},void 0,i(F,{attachment:o,onOpenMedia:R},"".concat(o.status.id,"+").concat(o.id)))}),!l&&t.size===0&&i("div",{className:"empty-column-indicator col-span-2 sm:col-span-3"},void 0,i(y,{id:"account_gallery.none",defaultMessage:"No media to show."})),g),l&&t.size===0&&i("div",{className:"slist__append"},void 0,i(_,{})))};export{K as default};
