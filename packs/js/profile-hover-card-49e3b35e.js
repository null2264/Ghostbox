import{d as z,a9 as D,u as N,r as v,ax as k,q as f,b6 as q,Z as T,iF as U,iG as g,R as $,az as j,W as G,a as e,b2 as J,a3 as O,hO as W,iH as Z,cC as K,ci as Q,H as V,A as X,hF as Y,y as h,F as i,hD as u,a2 as ee,iI as ae}from"../index-191ddf5f.js";import{u as te}from"./usePopper-ee219515.js";import{u as oe}from"./usePatronUser-3ebf3f61.js";var re=function(t,r){var s=[];return t!=null&&t.admin?s.push(e(u,{slug:"admin",title:e(i,{id:"account_moderation_modal.roles.admin",defaultMessage:"Admin"})},"admin")):t!=null&&t.moderator&&s.push(e(u,{slug:"moderator",title:e(i,{id:"account_moderation_modal.roles.moderator",defaultMessage:"Moderator"})},"moderator")),r!=null&&r.is_patron&&s.push(e(u,{slug:"patron",title:e(i,{id:"account.patron",defaultMessage:"Patron"})},"patron")),s},se=function(t){return function(){t(ae())}},ne=function(t){return function(){t(g(!0))}},de=function(t){var r,s=t.visible,p=s===void 0?!0:s,n=z(),y=D(),b=N(),M=v.useState(null),m=k(M,2),P=m[0],w=m[1],C=f(function(o){return o.me}),l=f(function(o){return o.profile_hover_card.accountId||void 0}),E=q(l,{withRelationship:!0}),a=E.account,H=oe(a==null?void 0:a.url),x=H.patronUser,A=f(function(o){var c;return(c=o.profile_hover_card.ref)===null||c===void 0?void 0:c.current}),B=re(a,x);v.useEffect(function(){l&&n(T([l]))},[n,l]),v.useEffect(function(){var o=y.listen(function(){U.cancel(),n(g())});return function(){o()}},[]);var _=te(A,P),I=_.styles,R=_.attributes;if(!a)return null;var S={__html:a.note_emojified},F=b.formatDate(a.created_at,{month:"long",year:"numeric"}),L=C!==a.id&&((r=a.relationship)===null||r===void 0?void 0:r.followed_by)===!0;return $.createElement("div",j({className:G({"absolute transition-opacity w-[320px] z-[101] top-0 left-0":!0,"opacity-100":p,"opacity-0 pointer-events-none":!p}),ref:w,style:I.popper},R.popper,{onMouseEnter:se(n),onMouseLeave:ne(n)}),e(ee,{variant:"rounded",className:"relative isolate overflow-hidden"},void 0,e(J,{},void 0,e(O,{space:2},void 0,e(W,{fetchComponent:Z},void 0,function(o){return e(o,{accountId:a.id,action:e(K,{account:a,small:!0}),badges:B})}),Q(a)?e(V,{alignItems:"center",space:.5},void 0,e(X,{src:Y,className:"h-4 w-4 text-gray-800 dark:text-gray-200"}),e(h,{size:"sm"},void 0,e(i,{id:"account.member_since",defaultMessage:"Joined {date}",values:{date:F}}))):null,a.note.length>0&&e(h,{size:"sm",dangerouslySetInnerHTML:S})),L&&e("div",{className:"absolute left-2 top-2"},void 0,e(u,{slug:"opaque",title:e(i,{id:"account.follows_you",defaultMessage:"Follows you"})})))))};export{de as ProfileHoverCard,de as default};
