import{d as z,u as G,t as H,q as D,js as O,r as s,ax as v,a as i,a3 as W,F as c,bw as J,o as K,R as C,y as R,jt as X,ju as Z,bH as $,jv as ee,jw as ie,bx as ae,br as m,jx as te}from"../index-4976718e.js";import"./es.promise.finally-c0dee3ef.js";var o=K({verificationInvalid:{id:"sms_verification.invalid",defaultMessage:"Please enter a valid phone number."},verificationSuccess:{id:"sms_verification.success",defaultMessage:"A verification code has been sent to your phone number."},verificationFail:{id:"sms_verification.fail",defaultMessage:"Failed to send SMS message to your phone number."},verificationExpired:{id:"sms_verification.expired",defaultMessage:"Your SMS token has expired."},verifySms:{id:"sms_verification.modal.verify_sms",defaultMessage:"Verify SMS"},verifyNumber:{id:"sms_verification.modal.verify_number",defaultMessage:"Verify phone number"},verifyCode:{id:"sms_verification.modal.verify_code",defaultMessage:"Verify code"}}),e=function(t){return t.IDLE="IDLE",t.READY="READY",t.REQUESTED="REQUESTED",t.FAIL="FAIL",t.SUCCESS="SUCCESS",t}(e||{}),se=function(I){var E=I.onClose,f=z(),r=G(),A=H(),g=D(function(a){return O(a)}),V=D(function(a){return a.verification.isLoading}),x=s.useState(e.IDLE),y=v(x,2),n=y[0],d=y[1],T=s.useState(),h=v(T,2),S=h[0],F=h[1],L=s.useState(""),M=v(L,2),l=M[0],k=M[1],U=s.useState(!1),p=v(U,2),Y=p[0],w=p[1],Q=!!S,j=s.useCallback(function(a){F(a)},[]),_=function(u){if(u.preventDefault(),!Q){d(e.IDLE),m.error(r.formatMessage(o.verificationInvalid));return}f(te(S)).then(function(){m.success(r.formatMessage(o.verificationSuccess))}).finally(function(){return d(e.REQUESTED)}).catch(function(){m.error(r.formatMessage(o.verificationFail))})},P=function(u){w(!0),_(u)},q=function(u){switch(n){case e.IDLE:d(e.READY);break;case e.READY:_(u);break;case e.REQUESTED:b();break}},N=s.useMemo(function(){switch(n){case e.IDLE:return r.formatMessage(o.verifySms);case e.READY:return r.formatMessage(o.verifyNumber);case e.REQUESTED:return r.formatMessage(o.verifyCode);default:return null}},[n]),B=function(){switch(n){case e.IDLE:return i(R,{theme:"muted"},void 0,i(c,{id:"sms_verification.modal.verify_help_text",defaultMessage:"Verify your phone number to start using {instance}.",values:{instance:A.title}}));case e.READY:return i($,{labelText:i(c,{id:"sms_verification.phone.label",defaultMessage:"Phone number"})},void 0,i(Z,{value:S,onChange:j,required:!0,autoFocus:!0}));case e.REQUESTED:return C.createElement(C.Fragment,null,i(R,{theme:"muted",size:"sm",align:"center"},void 0,i(c,{id:"sms_verification.modal.enter_code",defaultMessage:"We sent you a 6-digit code via SMS. Enter it below."})),i(X,{value:l,onChange:k,numInputs:6,isInputNum:!0,shouldAutoFocus:!0,isDisabled:V,containerStyle:"flex justify-center mt-2 space-x-4",inputStyle:"w-10i border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500"}));default:return null}},b=function(){g&&f(ee(l)).then(function(){d(e.SUCCESS),f(ie(g)).then(function(){return f(ae("VERIFY_SMS"))})}).catch(function(){return m.error(r.formatMessage(o.verificationExpired))})};return s.useEffect(function(){l.length===6&&b()},[l]),i(J,{title:i(c,{id:"sms_verification.modal.verify_title",defaultMessage:"Verify your phone number"}),onClose:function(){return E("VERIFY_SMS")},cancelAction:n===e.IDLE?function(){return E("VERIFY_SMS")}:void 0,cancelText:"Skip for now",confirmationAction:q,confirmationText:N,secondaryAction:n===e.REQUESTED?P:void 0,secondaryText:n===e.REQUESTED?i(c,{id:"sms_verification.modal.resend_code",defaultMessage:"Resend verification code?"}):void 0,secondaryDisabled:Y},void 0,i(W,{space:4},void 0,B()))};export{se as default};
