import{r as c,a as t,R as y,bI as w,H as x,ae as C,F as f,ax as M,bl as S,cs as I,d as N,es as R,a3 as k,y as D,bw as H,bx as A}from"../index-eb993cea.js";var T=function(a){var d=a.value,l=c.useRef(null),i=function(){var e;(e=l.current)===null||e===void 0||e.select(),navigator.clipboard?navigator.clipboard.writeText(d):document.execCommand("copy")};return t(x,{alignItems:"center"},void 0,y.createElement(w,{ref:l,type:"text",value:d,className:"rounded-r-none rtl:rounded-l-none rtl:rounded-r-lg",outerClassName:"grow",onClick:i,readOnly:!0}),t(C,{theme:"primary",className:"mt-1 h-full rounded-l-none rounded-r-lg rtl:rounded-l-lg rtl:rounded-r-none",onClick:i},void 0,t(f,{id:"input.copy",defaultMessage:"Copy"})))},W=function(a){var d=a.className,l=a.sandbox,i=a.title,s=a.html,e=c.useRef(null),p=c.useState(void 0),m=M(p,2),b=m[0],g=m[1],E=c.useCallback(function(r){var o;if(((o=r.data)===null||o===void 0?void 0:o.type)==="setHeight"){var n;g((n=r.data)===null||n===void 0?void 0:n.height)}},[]);return c.useEffect(function(){var r,o=(r=e.current)===null||r===void 0||(r=r.contentWindow)===null||r===void 0?void 0:r.document;if(o&&s){var n;o.open(),o.write(s),o.close(),o.body.style.margin="0",(n=e.current)===null||n===void 0||(n=n.contentWindow)===null||n===void 0||n.addEventListener("message",E);var h=o.querySelector("iframe");h&&(h.width="100%")}return function(){var u;(u=e.current)===null||u===void 0||(u=u.contentWindow)===null||u===void 0||u.removeEventListener("message",E)}},[e.current,s]),y.createElement("iframe",{ref:e,className:d,sandbox:l,height:b,title:i})};function B(v){const a=S();return I(["embed",v],async()=>{const{data:l}=await a.get("/api/oembed",{params:{url:v}});return l})}var q=function(a){var d=a.url,l=a.onError,i=N(),s=B(d),e=s.data,p=s.error,m=s.isError;c.useEffect(function(){p&&m&&l(p)},[m]);var b=function(){i(A("EMBED"))};return t(H,{title:t(f,{id:"status.embed",defaultMessage:"Embed post"}),onClose:b},void 0,t(k,{space:4},void 0,t(D,{theme:"muted"},void 0,t(f,{id:"embed.instructions",defaultMessage:"Embed this post on your website by copying the code below."})),t(T,{value:(e==null?void 0:e.html)||""})),t("div",{className:"py-9"},void 0,t(R,{})),t(W,{className:"w-full overflow-hidden rounded-xl",sandbox:"allow-same-origin allow-scripts",title:"embedded-status",html:e==null?void 0:e.html}))};export{q as default};
