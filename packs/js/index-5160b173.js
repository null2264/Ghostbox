import{R as k,a as e,P as W,H as Z,b as se,c as re,u as K,d as ee,f as te,g as le,v as ae,I as y,i as Y,k as G,l as ie,m as oe,n as D,T as ce,o as O,s as ue,r as h,p as de,q as R,t as fe,w as g,x as A,F as Q,y as me,L as ve,z as pe,E as ge,A as he,S as _e,B,C as Me,D as ye,G as be,J as we,K as J,M as Ne,N as $,O as xe,Q as H,U as X,V as S,W as qe,X as Re,Y as ke}from"../index-8f0cc4c0.js";import{P as je}from"./pull-to-refresh-8ff99f7a.js";import{S as Ie}from"./scroll-top-button-487438eb.js";import{S as Pe}from"./scrollable-list-19a022e9.js";import{v as Ce}from"./mood-smile-6a052395.js";import"./index-74b7a38f.js";import"./load-more-b10674f1.js";var Le=function(){return e("div",{className:"bg-white px-4 py-6 dark:bg-primary-900 sm:p-6"},void 0,e("div",{className:"w-full animate-pulse"},void 0,e("div",{className:"mb-2"},void 0,e(W,{minLength:20,maxLength:20})),e("div",{},void 0,e(Z,{space:3,alignItems:"center"},void 0,e("div",{className:"shrink-0"},void 0,e(se,{size:48})),e("div",{className:"min-w-0 flex-1"},void 0,e(re,{minLength:3,maxLength:25})))),e("div",{className:"mt-4"},void 0,e(W,{minLength:5,maxLength:120}))))};const Se=k.memo(Le);var f=O({all:{id:"notifications.filter.all",defaultMessage:"All"},mentions:{id:"notifications.filter.mentions",defaultMessage:"Mentions"},favourites:{id:"notifications.filter.favourites",defaultMessage:"Likes"},boosts:{id:"notifications.filter.boosts",defaultMessage:"Reposts"},polls:{id:"notifications.filter.polls",defaultMessage:"Poll results"},follows:{id:"notifications.filter.follows",defaultMessage:"Follows"},emoji_reacts:{id:"notifications.filter.emoji_reacts",defaultMessage:"Emoji reacts"},statuses:{id:"notifications.filter.statuses",defaultMessage:"Updates from people you follow"}}),Fe=function(){var t=K(),d=ee(),s=te(),i=le(),m=s.getIn(["notifications","quickFilter","active"]),c=s.getIn(["notifications","quickFilter","advanced"]),a=function(u){return function(){return d(ue(u))}},o=[{text:t.formatMessage(f.all),action:a("all"),name:"all"}];return c?(o.push({text:e(y,{src:ae}),title:t.formatMessage(f.mentions),action:a("mention"),name:"mention"}),o.push({text:e(y,{src:Y}),title:t.formatMessage(f.favourites),action:a("favourite"),name:"favourite"}),i.emojiReacts&&o.push({text:e(y,{src:Ce}),title:t.formatMessage(f.emoji_reacts),action:a("pleroma:emoji_reaction"),name:"pleroma:emoji_reaction"}),o.push({text:e(y,{src:G}),title:t.formatMessage(f.boosts),action:a("reblog"),name:"reblog"}),o.push({text:e(y,{src:ie}),title:t.formatMessage(f.polls),action:a("poll"),name:"poll"}),o.push({text:e(y,{src:oe}),title:t.formatMessage(f.statuses),action:a("status"),name:"status"}),o.push({text:e(y,{src:D}),title:t.formatMessage(f.follows),action:a("follow"),name:"follow"})):o.push({text:t.formatMessage(f.mentions),action:a("mention"),name:"mention"}),e(ce,{items:o,activeItem:m})};const De="/packs/assets/calendar-time-e551770b.svg";var Te=function(t,d,s){var i=[d];return i.push(t.formatDate(s,{hour:"2-digit",minute:"2-digit",month:"short",day:"numeric"})),i.join(", ")},Ue=function(t){return e("bdi",{},void 0,e(ve,{className:"font-bold text-gray-800 hover:underline dark:text-gray-200",title:t.acct,to:"/@".concat(t.acct),dangerouslySetInnerHTML:{__html:t.display_name_html}}))},ze={follow:D,follow_request:D,mention:ae,favourite:Y,group_favourite:Y,reblog:G,group_reblog:G,status:oe,poll:ie,move:Me,"pleroma:chat_mention":ye,"pleroma:emoji_reaction":be,user_approved:D,update:we,"pleroma:event_reminder":De,"pleroma:participation_request":J,"pleroma:participation_accepted":J},Ee=pe({id:"notification.name",defaultMessage:"{link}{others}"}),ne=O({follow:{id:"notification.follow",defaultMessage:"{name} followed you"},follow_request:{id:"notification.follow_request",defaultMessage:"{name} has requested to follow you"},mention:{id:"notification.mentioned",defaultMessage:"{name} mentioned you"},favourite:{id:"notification.favourite",defaultMessage:"{name} liked your post"},group_favourite:{id:"notification.group_favourite",defaultMessage:"{name} liked your group post"},reblog:{id:"notification.reblog",defaultMessage:"{name} reposted your post"},group_reblog:{id:"notification.group_reblog",defaultMessage:"{name} reposted your group post"},status:{id:"notification.status",defaultMessage:"{name} just posted"},poll:{id:"notification.poll",defaultMessage:"A poll you have voted in has ended"},move:{id:"notification.move",defaultMessage:"{name} moved to {targetName}"},"pleroma:chat_mention":{id:"notification.pleroma:chat_mention",defaultMessage:"{name} sent you a message"},"pleroma:emoji_reaction":{id:"notification.pleroma:emoji_reaction",defaultMessage:"{name} reacted to your post"},user_approved:{id:"notification.user_approved",defaultMessage:"Welcome to {instance}!"},update:{id:"notification.update",defaultMessage:"{name} edited a post you interacted with"},"pleroma:event_reminder":{id:"notification.pleroma:event_reminder",defaultMessage:"An event you are participating in starts soon"},"pleroma:participation_request":{id:"notification.pleroma:participation_request",defaultMessage:"{name} wants to join your event"},"pleroma:participation_accepted":{id:"notification.pleroma:participation_accepted",defaultMessage:"You were accepted to join the event"}}),Ae=function(t,d,s,i,m,c){var a=Ue(s),o=t.formatMessage(Ee,{link:a,others:i&&i>0?e(Q,{id:"notification.others",defaultMessage:" + {count, plural, one {# other} other {# others}}",values:{count:i-1}}):""});return t.formatMessage(ne[d],{name:o,targetName:m,instance:c})},F=48,Be=function(t){var d=t.hidden,s=d===void 0?!1:d,i=t.onMoveUp,m=t.onMoveDown,c=h.useCallback(de(),[]),a=R(function(v){return c(v,t.notification)}),o=K(),j=fe(),u=a.type,r=a.account,_=a.status,I=function(){i&&i(a.id)},P=function(){m&&m(a.id)},N=function(){return u==="pleroma:emoji_reaction"&&a.emoji?e(ge,{emoji:a.emoji,src:a.emoji_url||void 0,className:"h-4 w-4 flex-none"}):A(u)?e(he,{src:ze[u],size:16,className:"flex-none text-primary-600 dark:text-primary-400"}):null},T=function(){switch(u){case"follow":case"user_approved":return{type:0,content:r&&g(r)==="object"?e(B,{id:r.id,hidden:s,avatarSize:F,withRelationship:!0}):null};case"follow_request":return{type:0,content:r&&g(r)==="object"?e(B,{id:r.id,hidden:s,avatarSize:F,actionType:"follow_request",withRelationship:!0}):null};case"move":return{type:0,content:r&&g(r)==="object"&&a.target&&g(a.target)==="object"?e(B,{id:a.target.id,hidden:s,avatarSize:F,withRelationship:!0}):null};case"favourite":case"group_favourite":case"mention":case"reblog":case"group_reblog":case"status":case"poll":case"update":case"pleroma:emoji_reaction":case"pleroma:event_reminder":case"pleroma:participation_accepted":case"pleroma:participation_request":return{type:1,content:_&&g(_)==="object"?e(_e,{status:_,hidden:s,onMoveDown:P,onMoveUp:I,avatarSize:F,showGroup:!1,notification:{icon:N(),text:x}}):null};default:return{type:-1,content:null}}},C=a.target&&g(a.target)==="object"?a.target.acct:"",x=A(u)&&r&&g(r)==="object"?Ae(o,u,r,a.total_count,C,j.title):null,L=A(u)?Te(o,o.formatMessage(ne[u],{name:r&&g(r)==="object"?r.acct:"",targetName:C}),a.created_at):"",U=function(){var p=T(),z=p.type,q=p.content;return k.createElement(k.Fragment,null,q!==null&&z!==1&&e("div",{className:"mb-2"},void 0,e(Z,{alignItems:"center",space:3},void 0,e("div",{className:"flex justify-end"},void 0,N()),e("div",{className:"truncate"},void 0,e(me,{theme:"muted",size:"xs",truncate:!0,"data-testid":"message"},void 0,x)))),q!==null&&e("div",{},void 0,q))};return e("div",{className:"notification focusable",tabIndex:0,"aria-label":L},void 0,e("div",{className:"focusable p-4"},void 0,U()))},$e=O({title:{id:"column.notifications",defaultMessage:"Notifications"}}),He=Ne([function(l){return $(l).getIn(["notifications","quickFilter","show"])},function(l){return $(l).getIn(["notifications","quickFilter","active"])},function(l){return xe($(l).getIn(["notifications","shows"]).filter(function(t){return!t}).keys())},function(l){return l.notifications.items.toList()}],function(l,t,d,s){return!l||t==="all"?s.filterNot(function(i){return i!==null&&d.includes(i.get("type"))}):s.filter(function(i){return i!==null&&t===i.get("type")})}),Je=function(){var t=ee(),d=K(),s=te(),i=s.getIn(["notifications","quickFilter","show"]),m=s.getIn(["notifications","quickFilter","active"]),c=R(function(n){return He(n)}),a=R(function(n){return n.notifications.isLoading}),o=R(function(n){return n.notifications.hasMore}),j=R(function(n){return n.notifications.totalQueuedNotificationsCount||0}),u=h.useRef(null),r=h.useRef(null),_=h.useRef(null),I=h.useCallback(H(function(){var n=c.last();t(X({maxId:n&&n.get("id")}))},300,{leading:!0}),[c]),P=h.useCallback(H(function(){t(S(!0))},100),[]),N=h.useCallback(H(function(){t(S(!1))},100),[]),T=function(b){var M=c.findIndex(function(w){return w!==null&&w.get("id")===b})-1;x(M)},C=function(b){var M=c.findIndex(function(w){return w!==null&&w.get("id")===b})+1;x(M)},x=function(b){var M;(M=u.current)===null||M===void 0||M.scrollIntoView({index:b,behavior:"smooth",done:function(){var E=r.current,V=E==null?void 0:E.querySelector('[data-index="'.concat(b,'"] .focusable'));V&&V.focus()}})},L=function(){t(ke())},U=function(){return t(X())};h.useEffect(function(){return L(),t(S(!0)),function(){I.cancel(),P.cancel(),N.cancel(),t(S(!1))}},[]);var v=m==="all"?e(Q,{id:"empty_column.notifications",defaultMessage:"You don't have any notifications yet. Interact with others to start the conversation."}):e(Q,{id:"empty_column.notifications_filtered",defaultMessage:"You don't have any notifications of this type yet."}),p=null,z=i?e(Fe,{}):null;a&&_.current?p=_.current:c.size>0||o?p=c.map(function(n){return e(Be,{notification:n,onMoveUp:T,onMoveDown:C},n.id)}):p=null,_.current=p;var q=k.createElement(Pe,{ref:u,scrollKey:"notifications",isLoading:a,showLoading:a&&c.size===0,hasMore:o,emptyMessage:v,placeholderComponent:Se,placeholderCount:20,onLoadMore:I,onScrollToTop:P,onScroll:N,className:qe({"divide-y divide-gray-200 dark:divide-primary-800 divide-solid":c.size>0,"space-y-2":c.size===0})},p);return k.createElement(Re,{ref:r,label:d.formatMessage($e.title),withHeader:!1},z,e(Ie,{onClick:L,count:j,type:"notification"}),e(je,{onRefresh:U},void 0,q))};export{Je as default};
