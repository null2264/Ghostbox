import{bl as Z,kL as ee,bn as ae,bo as te,r as p,u as re,t as se,ea as oe,ax as w,q as ne,a,aF as ie,bG as ue,R as v,az as g,bH as C,F as f,bI as de,A as le,dd as pe,b_ as ce,bK as me,ae as ve,X as ge,f3 as fe,f4 as he,o as _e,aT as be,br as H,bN as k}from"../index-63e120fe.js";import"./es.array.splice-5d1a196c.js";import{u as Se}from"./useGroupTags-d5c5ecb1.js";import{u as L}from"./useImageField-c3e8da35.js";import{H as xe,A as Ge}from"./header-picker-e802a11f.js";import{G as ye}from"./group-tags-field-2d803a89.js";import"./photo-plus-14444f2c.js";import"./streamfield-73a189c1.js";function Te(s){const t=Z(),{createEntity:o,...n}=ee([te.GROUPS],i=>t.put(`/api/v1/groups/${s}`,i,{headers:{"Content-Type":"multipart/form-data"}}),{schema:ae});return{updateGroup:o,...n}}function $(s){const[t,o]=p.useState(s),n=typeof s=="string",i=d=>{o(d.target.value)};return p.useEffect(()=>{n&&o(s)},[n]),{value:t||"",onChange:i}}var Ae=function(t){return t&&fe(t)?void 0:t},Ee=function(t){return t&&he(t)?void 0:t},h=_e({heading:{id:"navigation_bar.edit_group",defaultMessage:"Edit Group"},groupNamePlaceholder:{id:"manage_group.fields.name_placeholder",defaultMessage:"Group Name"},groupDescriptionPlaceholder:{id:"manage_group.fields.description_placeholder",defaultMessage:"Description"},groupSaved:{id:"group.update.success",defaultMessage:"Group successfully saved"}}),Ce=function(t){var o,n,i=t.params.groupId,d=re(),y=se(),T=oe(i),e=T.group,U=T.isLoading,q=Te(i),j=q.updateGroup,z=Se(i),B=z.invalidate,K=p.useState(!1),A=w(K,2),_=A[0],E=A[1],O=p.useState([""]),M=w(O,2),c=M[0],m=M[1],b=L({maxPixels:400*400,preview:Ae(e==null?void 0:e.avatar)}),S=L({maxPixels:1920*1080,preview:Ee(e==null?void 0:e.header)}),I=$(e==null?void 0:e.display_name),N=$(e==null?void 0:e.note_plain),W=Number(y.configuration.groups.max_characters_name),X=Number(y.configuration.groups.max_characters_description),R=(o=(n=ne(function(r){return r.instance.configuration.media_attachments.supported_mime_types}))===null||n===void 0?void 0:n.filter(function(r){return r.startsWith("image/")}).join(","))!==null&&o!==void 0?o:"";function J(){return x.apply(this,arguments)}function x(){return x=be(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return E(!0),u.next=3,j({display_name:I.value,note:N.value,avatar:b.file===null?"":b.file,header:S.file===null?"":S.file,tags:c},{onSuccess:function(){B(),H.success(d.formatMessage(h.groupSaved))},onError:function(P){var l,G,F=(l=P.response)===null||l===void 0||(l=l.data)===null||l===void 0?void 0:l.error;((G=P.response)===null||G===void 0?void 0:G.status)===422&&typeof F<"u"&&H.error(F)}});case 3:E(!1);case 4:case"end":return u.stop()}},r)})),x.apply(this,arguments)}var Q=function(){m([].concat(k(c),[""]))},V=function(D){var u=k(c);u.splice(D,1),m(u)};return p.useEffect(function(){e&&m(e.tags.map(function(r){return r.name}))},[e==null?void 0:e.id]),U?a(ie,{}):a(ge,{label:d.formatMessage(h.heading)},void 0,a(ue,{onSubmit:J},void 0,a("div",{className:"relative mb-12 flex"},void 0,v.createElement(xe,g({accept:R,disabled:_},S)),v.createElement(Ge,g({accept:R,disabled:_},b))),a(C,{labelText:a(f,{id:"manage_group.fields.name_label_optional",defaultMessage:"Group name"}),hintText:a(f,{id:"manage_group.fields.cannot_change_hint",defaultMessage:"This cannot be changed after the group is created."})},void 0,v.createElement(de,g({type:"text",placeholder:d.formatMessage(h.groupNamePlaceholder),maxLength:W},I,{append:a(le,{className:"h-5 w-5 text-gray-600",src:pe}),disabled:!0}))),a(C,{labelText:a(f,{id:"manage_group.fields.description_label",defaultMessage:"Description"})},void 0,v.createElement(ce,g({autoComplete:"off",placeholder:d.formatMessage(h.groupDescriptionPlaceholder),maxLength:X},N))),a("div",{className:"pb-6"},void 0,a(ye,{tags:c,onChange:m,onAddItem:Q,onRemoveItem:V})),a(me,{},void 0,a(ve,{theme:"primary",type:"submit",disabled:_,block:!0},void 0,a(f,{id:"edit_profile.save",defaultMessage:"Save"})))))};export{Ce as default};
