import{bl as _,d as M,gy as m,g as A,f1 as D,j5 as I,fC as x,j6 as y,Z as L}from"../index-c29ef263.js";const f={suggestions:["suggestions"]},b=s=>({id:s.account_id,avatar:s.account_avatar,avatar_static:s.account_avatar,acct:s.acct,display_name:s.display_name,note:s.note,verified:s.verified}),j=()=>{var i;const s=_(),a=M(),p=A(),d=async t=>{var r;const c=(t==null?void 0:t.link)||"/api/v2/suggestions",e=await s.get(c),k=!!e.headers.link,l=(r=x(e).refs.find(u=>u.rel==="next"))==null?void 0:r.uri,o=e.data.map(({account:u})=>u),v=o.map(u=>u.id);return a(y(o)),a(L(v)),{result:e.data.map(u=>({...u,account:u.account.id})),link:l,hasMore:k}},S=async t=>{var v;const c=(t==null?void 0:t.link)||"/api/v1/truth/carousels/suggestions",e=await s.get(c),k=!!e.headers.link,l=(v=x(e).refs.find(r=>r.rel==="next"))==null?void 0:v.uri,o=e.data.map(b);return a(y(o,{should_refetch:!0})),{result:e.data.map(r=>({...r,account:r.account_id})),link:l,hasMore:k}},h=t=>p.truthSuggestions?S(t):d(t),n=m(f.suggestions,({pageParam:t})=>h(t),{keepPreviousData:!0,getNextPageParam:t=>{if(t!=null&&t.hasMore)return{nextLink:t==null?void 0:t.link}}}),g=(i=n.data)==null?void 0:i.pages.reduce((t,c)=>[...t,...c.result],[]);return{...n,data:g||[]}},F=()=>{const s=_();return D(a=>s.delete(`/api/v1/suggestions/${a}`),{onMutate(a){I(f.suggestions,a,(p,d)=>p.account===d)}})};function N(){var h;const s=_(),a=M(),p=async n=>{var l;const g=(n==null?void 0:n.link)||"/api/v2/suggestions",i=await s.get(g),t=!!i.headers.link,c=(l=x(i).refs.find(o=>o.rel==="next"))==null?void 0:l.uri,e=i.data.map(({account:o})=>o),k=e.map(o=>o.id);return a(y(e)),a(L(k)),{data:i.data,link:c,hasMore:t}},d=m(["suggestions","v2"],({pageParam:n})=>p(n),{keepPreviousData:!0,getNextPageParam:n=>{if(n.hasMore)return{link:n.link}}}),S=(h=d.data)==null?void 0:h.pages.reduce((n,g)=>[...n,...g.data],[]);return{...d,data:S}}export{F as a,N as b,j as u};
