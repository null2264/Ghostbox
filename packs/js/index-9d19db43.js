import{v as it}from"./arrows-minimize-7c27a12c.js";import{u as lt,r as u,at as m,cl as W,Q as ct,R as p,W as k,a as s,dj as dt,A as V,dx as vt,dy as ft,dk as mt,o as pt}from"../index-5dcc55da.js";import{v as ht}from"./volume-08f8a8f1.js";import"./web.url.constructor-7bed0a10.js";import"./es.array.last-index-of-23f4af5b.js";import{a as gt,m as yt,i as _t,c as bt}from"./media-aspect-ratio-df6a7bb1.js";const Et="/packs/assets/arrows-maximize-91f2dae6.svg",Mt="/packs/assets/player-pause-3dad6718.svg",Se=()=>!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement),xe=()=>{document.exitFullscreen?document.exitFullscreen():"webkitExitFullscreen"in document?document.webkitExitFullscreen():"mozCancelFullScreen"in document&&document.mozCancelFullScreen()},wt=v=>{v.requestFullscreen?v.requestFullscreen():"webkitRequestFullscreen"in v?v.webkitRequestFullscreen():"mozRequestFullScreen"in v&&v.mozRequestFullScreen()};var A=300,d=pt({play:{id:"video.play",defaultMessage:"Play"},pause:{id:"video.pause",defaultMessage:"Pause"},mute:{id:"video.mute",defaultMessage:"Mute sound"},unmute:{id:"video.unmute",defaultMessage:"Unmute sound"},hide:{id:"video.hide",defaultMessage:"Hide video"},expand:{id:"video.expand",defaultMessage:"Expand video"},close:{id:"video.close",defaultMessage:"Close video"},fullscreen:{id:"video.fullscreen",defaultMessage:"Full screen"},exit_fullscreen:{id:"video.exit_fullscreen",defaultMessage:"Exit full screen"}}),X=function(n){var r=Math.floor(n/3600),l=Math.floor((n-r*3600)/60),i=n-r*3600-l*60;return r<10&&(r="0"+r),l<10&&(l="0"+l),i<10&&(i="0"+i),(r==="00"?"":"".concat(r,":"))+"".concat(l,":").concat(i)},Re=function(n){var r;if(n.getBoundingClientRect&&n.parentNode&&(r=n.getBoundingClientRect()),!r)return{left:0,top:0};var l=document.documentElement,i=document.body,E=l.clientLeft||i.clientLeft||0,M=window.pageXOffset||i.scrollLeft,w=r.left+M-E,L=l.clientTop||i.clientTop||0,h=window.pageYOffset||i.scrollTop,D=r.top+h-L;return{left:Math.round(w),top:Math.round(D)}},Y=function(n,r){var l=Re(n),i=n.offsetWidth,E=n.offsetHeight,M=l.top,w=l.left,L=r.pageY,h=r.pageX;return r.changedTouches&&(h=r.changedTouches[0].pageX,L=r.changedTouches[0].pageY),{y:Math.max(0,Math.min(1,(L-M)/E)),x:Math.max(0,Math.min(1,(h-w)/i))}},Lt=function(n){var r=new URL(n),l=r.pathname,i=l.lastIndexOf("/");return l.substring(i+1)},Pt=function(n){var r=n.width,l=n.visible,i=l===void 0?!1:l,E=n.detailed,M=E===void 0?!1:E,w=n.autoFocus,L=w===void 0?!1:w,h=n.cacheWidth,D=n.startTime,De=n.src,S=n.height,j=n.alt,$=n.inline,G=n.aspectRatio,q=G===void 0?16/9:G,Q=n.link,Fe=n.blurhash,J=n.sensitiveOverlay,Ne=J===void 0?null:J,Z=n.onToggleVisibility,Te=Z===void 0?function(){}:Z,g=lt(),F=u.useRef(null),b=u.useRef(null),t=u.useRef(null),U=u.useRef(null),z=u.useRef(null),Ce=u.useState(0),ee=m(Ce,2),te=ee[0],B=ee[1],Ve=u.useState(0),ae=m(Ve,2),ne=ae[0],qe=ae[1],Ue=u.useState(.5),re=m(Ue,2),oe=re[0],H=re[1],ze=u.useState(!0),ue=m(ze,2),y=ue[0],N=ue[1],Be=u.useState(!1),se=m(Be,2),He=se[0],ie=se[1],Ie=u.useState(r),le=m(Ie,2),P=le[0],Oe=le[1],Ke=u.useState(!1),ce=m(Ke,2),f=ce[0],We=ce[1],Ae=u.useState(!1),de=m(Ae,2),ve=de[0],fe=de[1],Xe=u.useState(!1),me=m(Xe,2),I=me[0],O=me[1],Ye=u.useState(0),pe=m(Ye,2),je=pe[0],$e=pe[1],he=function(){if(b.current){var e=b.current.offsetWidth;h&&h(e),Oe(e)}};u.useLayoutEffect(function(){he()},[b.current]),u.useEffect(function(){t.current&&(H(t.current.volume),O(t.current.muted))},[t.current]);var Ge=function(e){return e.stopPropagation()},Qe=function(){N(!1)},Je=function(){N(!0)},Ze=function(){t.current&&(B(Math.floor(t.current.currentTime)),qe(Math.floor(t.current.duration)))},et=function(e){document.addEventListener("mousemove",x,!0),document.addEventListener("mouseup",ge,!0),document.addEventListener("touchmove",x,!0),document.addEventListener("touchend",ge,!0),x(e),e.preventDefault(),e.stopPropagation()},ge=function a(){document.removeEventListener("mousemove",x,!0),document.removeEventListener("mouseup",a,!0),document.removeEventListener("touchmove",x,!0),document.removeEventListener("touchend",a,!0)},x=W(function(a){if(z.current){var e=Y(z.current,a),o=e.x;if(!isNaN(o)){var c=o;o>1?c=1:o<0&&(c=0),t.current&&(t.current.volume=c),H(c)}}},60),tt=function(e){var o;document.addEventListener("mousemove",R,!0),document.addEventListener("mouseup",ye,!0),document.addEventListener("touchmove",R,!0),document.addEventListener("touchend",ye,!0),ie(!0),(o=t.current)===null||o===void 0||o.pause(),R(e),e.preventDefault(),e.stopPropagation()},ye=function a(){var e;document.removeEventListener("mousemove",R,!0),document.removeEventListener("mouseup",a,!0),document.removeEventListener("touchmove",R,!0),document.removeEventListener("touchend",a,!0),ie(!1),(e=t.current)===null||e===void 0||e.play()},R=W(function(a){if(U.current&&t.current){var e=Y(U.current,a),o=e.x,c=Math.floor(t.current.duration*o);isNaN(c)||(t.current.currentTime=c,B(c))}},60),T=function(e){if(t.current){var o=t.current.currentTime+e;isNaN(o)||(B(o),t.current.currentTime=o)}},_e=function(e){e.key===" "&&(e.preventDefault(),e.stopPropagation(),C())},at=function(e){var o=.04;switch(e.key){case"k":e.preventDefault(),e.stopPropagation(),C();break;case"m":e.preventDefault(),e.stopPropagation(),we();break;case"f":e.preventDefault(),e.stopPropagation(),be();break;case"j":e.preventDefault(),e.stopPropagation(),T(-10);break;case"l":e.preventDefault(),e.stopPropagation(),T(10);break;case",":e.preventDefault(),e.stopPropagation(),T(-o);break;case".":e.preventDefault(),e.stopPropagation(),T(o);break}f&&(e.preventDefault(),e.stopPropagation(),e.key==="Escape"&&xe())},C=function(e){if(e==null||e.stopPropagation(),N(!y),y){var o;(o=t.current)===null||o===void 0||o.play()}else{var c;(c=t.current)===null||c===void 0||c.pause()}},be=function(){Se()?xe():b.current&&wt(b.current)},Ee=u.useCallback(ct(function(){he()},250,{trailing:!0}),[b.current,h]),Me=u.useCallback(W(function(){if(t.current){var a=t.current.getBoundingClientRect(),e=a.top,o=a.height,c=e<=(window.innerHeight||document.documentElement.clientHeight)&&e+o>=0;!y&&!c&&(N(!0),t.current.pause())}},150,{trailing:!0}),[t.current,y]),_=u.useCallback(function(){We(Se())},[]),nt=function(){fe(!0)},rt=function(){fe(!1)},we=function(){if(t.current){var e=!t.current.muted;O(!e),t.current.muted=e}},ot=function(){t.current&&D&&(t.current.currentTime=D,t.current.play())},ut=function(){t.current&&t.current.buffered.length>0&&$e(t.current.buffered.end(0)/t.current.duration*100)},st=function(){t.current&&(H(t.current.volume),O(t.current.muted))},Le=te/ne*100,Pe={},K=A;if($&&P){r=P;var ke=P/(16/9);gt(q)?S=Math.max(Math.floor(P/yt),ke):_t(q)?S=Math.max(Math.floor(P/bt),ke):S=Math.floor(P/q),K=S||A,Pe.height=K}return u.useEffect(function(){F.current&&(F.current.style.height="".concat(K,"px"))},[F.current]),u.useEffect(function(){return document.addEventListener("fullscreenchange",_,!0),document.addEventListener("webkitfullscreenchange",_,!0),document.addEventListener("mozfullscreenchange",_,!0),document.addEventListener("MSFullscreenChange",_,!0),window.addEventListener("scroll",Me),window.addEventListener("resize",Ee,{passive:!0}),function(){window.removeEventListener("scroll",Me),window.removeEventListener("resize",Ee),document.removeEventListener("fullscreenchange",_,!0),document.removeEventListener("webkitfullscreenchange",_,!0),document.removeEventListener("mozfullscreenchange",_,!0),document.removeEventListener("MSFullscreenChange",_,!0)}},[]),u.useEffect(function(){if(!i){var a;(a=t.current)===null||a===void 0||a.pause()}},[i]),p.createElement(p.Fragment,null,p.createElement("div",{className:k({hidden:!f}),ref:F}),p.createElement("div",{role:"menuitem",className:k("video-player",{detailed:M,"video-player--inline":$&&!f,fullscreen:f}),style:Pe,ref:b,onMouseEnter:nt,onMouseLeave:rt,onClick:Ge,onKeyDown:at,tabIndex:0},Ne,!f&&s(dt,{hash:Fe,className:"media-gallery__preview"}),p.createElement("video",{ref:t,src:De,loop:!0,role:"button",tabIndex:0,"aria-label":j,title:j,width:r,height:S||A,onClick:C,onKeyDown:_e,onPlay:Qe,onPause:Je,onTimeUpdate:Ze,onLoadedData:ot,onProgress:ut,onVolumeChange:st,style:{display:i?"block":"none"}}),i&&p.createElement(p.Fragment,null,s("div",{className:k("video-player__controls",{active:y||ve})},void 0,p.createElement("div",{className:"video-player__seek",onMouseDown:tt,ref:U},s("div",{className:"video-player__seek__buffer",style:{width:"".concat(je,"%")}}),s("div",{className:"video-player__seek__progress",style:{width:"".concat(Le,"%")}}),s("span",{className:k("video-player__seek__handle",{active:He}),tabIndex:0,style:{left:"".concat(Le,"%")},onKeyDown:_e})),s("div",{className:"video-player__buttons-bar"},void 0,s("div",{className:"video-player__buttons left"},void 0,s("button",{type:"button",title:g.formatMessage(y?d.play:d.pause),"aria-label":g.formatMessage(y?d.play:d.pause),className:"player-button",onClick:C,autoFocus:L},void 0,s(V,{src:y?vt:Mt})),s("button",{type:"button",title:g.formatMessage(I?d.unmute:d.mute),"aria-label":g.formatMessage(I?d.unmute:d.mute),className:"player-button",onClick:we},void 0,s(V,{src:I?ft:ht})),p.createElement("div",{className:k("video-player__volume",{active:ve}),onMouseDown:et,ref:z},s("div",{className:"video-player__volume__current",style:{width:"".concat(oe*100,"%")}}),s("span",{className:k("video-player__volume__handle"),tabIndex:0,style:{left:"".concat(oe*100,"%")}})),(M||f)&&s("span",{},void 0,s("span",{className:"video-player__time-current"},void 0,X(te)),s("span",{className:"video-player__time-sep"},void 0,"/"),s("span",{className:"video-player__time-total"},void 0,X(ne))),Q&&s("span",{className:"video-player__link"},void 0,Q)),s("div",{className:"video-player__buttons right"},void 0,!f&&s("button",{type:"button",title:g.formatMessage(d.hide),"aria-label":g.formatMessage(d.hide),className:"player-button",onClick:Te},void 0,s(V,{src:mt})),s("button",{type:"button",title:g.formatMessage(f?d.exit_fullscreen:d.fullscreen),"aria-label":g.formatMessage(f?d.exit_fullscreen:d.fullscreen),className:"player-button",onClick:be},void 0,s(V,{src:f?it:Et}))))))))};const Nt=Object.freeze(Object.defineProperty({__proto__:null,default:Pt,fileNameFromURL:Lt,findElementPosition:Re,formatTime:X,getPointerPosition:Y},Symbol.toStringTag,{value:"Module"}));export{Pt as V,Et as a,X as f,Y as g,Nt as i,Mt as v};
