import{fz as i,bp as d,o as l,fA as S,fB as T,d as M,u as x,r as C,at as h,a as n,bI as v,aa as L,y as m,bE as y,X as R}from"../index-deab185c.js";const w="EXPORT_FOLLOWS_REQUEST",k="EXPORT_FOLLOWS_SUCCESS",U="EXPORT_FOLLOWS_FAIL",X="EXPORT_BLOCKS_REQUEST",P="EXPORT_BLOCKS_SUCCESS",A="EXPORT_BLOCKS_FAIL",F="EXPORT_MUTES_REQUEST",B="EXPORT_MUTES_SUCCESS",I="EXPORT_MUTES_FAIL",_=l({blocksSuccess:{id:"export_data.success.blocks",defaultMessage:"Blocks exported successfully"},followersSuccess:{id:"export_data.success.followers",defaultMessage:"Followers exported successfully"},mutesSuccess:{id:"export_data.success.mutes",defaultMessage:"Mutes exported successfully"}});function p(s,t){const e=document.createElement("a");e.setAttribute("href","data:text/csv;charset=utf-8,"+encodeURIComponent(s)),e.setAttribute("download",t),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}const f=s=>async t=>{const e=t.data;let a=[],c=S(t).refs.find(o=>o.rel==="next");for(;c;)t=await i(s).get(c.uri),c=S(t).refs.find(o=>o.rel==="next"),Array.prototype.push.apply(e,t.data);return a=e.map(o=>T(o).fqn),Array.from(new Set(a))},K=()=>(s,t)=>{s({type:w});const e=t().me;return i(t).get(`/api/v1/accounts/${e}/following?limit=40`).then(f(t)).then(a=>{a=a.map(c=>c+",true"),a.unshift("Account address,Show boosts"),p(a.join(`
`),"export_followings.csv"),d.success(_.followersSuccess),s({type:k})}).catch(a=>{s({type:U,error:a})})},Q=()=>(s,t)=>(s({type:X}),i(t).get("/api/v1/blocks?limit=40").then(f(t)).then(e=>{p(e.join(`
`),"export_block.csv"),d.success(_.blocksSuccess),s({type:P})}).catch(e=>{s({type:A,error:e})})),W=()=>(s,t)=>(s({type:F}),i(t).get("/api/v1/mutes?limit=40").then(f(t)).then(e=>{p(e.join(`
`),"export_mutes.csv"),d.success(_.mutesSuccess),s({type:B})}).catch(e=>{s({type:I,error:e})}));var u=function(t){var e=t.messages,a=t.action,c=M(),o=x(),g=C.useState(!1),E=h(g,2),O=E[0],r=E[1],b=function($){r(!0),c(a()).then(function(){r(!1)}).catch(function(){r(!1)})};return n(y,{},void 0,n(m,{size:"xl",weight:"bold"},void 0,o.formatMessage(e.input_label)),n(m,{theme:"muted"},void 0,o.formatMessage(e.input_hint)),n(v,{},void 0,n(L,{theme:"primary",onClick:b,disabled:O},void 0,o.formatMessage(e.submit))))},V=l({heading:{id:"column.export_data",defaultMessage:"Export data"},submit:{id:"export_data.actions.export",defaultMessage:"Export"}}),D=l({input_label:{id:"export_data.follows_label",defaultMessage:"Follows"},input_hint:{id:"export_data.hints.follows",defaultMessage:"Get a CSV file containing a list of followed accounts"},submit:{id:"export_data.actions.export_follows",defaultMessage:"Export follows"}}),j=l({input_label:{id:"export_data.blocks_label",defaultMessage:"Blocks"},input_hint:{id:"export_data.hints.blocks",defaultMessage:"Get a CSV file containing a list of blocked accounts"},submit:{id:"export_data.actions.export_blocks",defaultMessage:"Export blocks"}}),z=l({input_label:{id:"export_data.mutes_label",defaultMessage:"Mutes"},input_hint:{id:"export_data.hints.mutes",defaultMessage:"Get a CSV file containing a list of muted accounts"},submit:{id:"export_data.actions.export_mutes",defaultMessage:"Export mutes"}}),H=function(){var t=x();return n(R,{label:t.formatMessage(V.heading)},void 0,n(u,{action:K,messages:D}),n(u,{action:Q,messages:j}),n(u,{action:W,messages:z}))};export{H as default};
