import{R,a as e,P as W,H as ee,b as re,c as le,u as K,d as te,f as ae,g as ce,v as ie,I as y,i as Y,k as G,l as oe,m as ne,n as D,T as ue,o as O,s as de,r as h,p as fe,q as k,t as me,w as g,x as A,F as Q,y as ve,L as pe,z as ge,E as he,A as _e,S as Me,B,C as ye,D as be,G as we,J as Ne,K as J,M as qe,N as $,O as xe,Q as H,U as X,V as S,W as ke,X as Re,Y as je}from"../index-eb993cea.js";import{P as Ie}from"./pull-to-refresh-2dc25438.js";import{S as Ce}from"./scroll-top-button-5ef62742.js";import{S as Pe}from"./scrollable-list-0cd38e3d.js";import{v as Le}from"./mood-smile-6a052395.js";import"./index-bdb42fd0.js";import"./load-more-71cf0d4e.js";var Se=function(){return e("div",{className:"bg-white px-4 py-6 dark:bg-primary-900 sm:p-6"},void 0,e("div",{className:"w-full animate-pulse"},void 0,e("div",{className:"mb-2"},void 0,e(W,{minLength:20,maxLength:20})),e("div",{},void 0,e(ee,{space:3,alignItems:"center"},void 0,e("div",{className:"shrink-0"},void 0,e(re,{size:48})),e("div",{className:"min-w-0 flex-1"},void 0,e(le,{minLength:3,maxLength:25})))),e("div",{className:"mt-4"},void 0,e(W,{minLength:5,maxLength:120}))))};const Fe=R.memo(Se);var f=O({all:{id:"notifications.filter.all",defaultMessage:"All"},mentions:{id:"notifications.filter.mentions",defaultMessage:"Mentions"},favourites:{id:"notifications.filter.favourites",defaultMessage:"Likes"},boosts:{id:"notifications.filter.boosts",defaultMessage:"Reposts"},polls:{id:"notifications.filter.polls",defaultMessage:"Poll results"},follows:{id:"notifications.filter.follows",defaultMessage:"Follows"},emoji_reacts:{id:"notifications.filter.emoji_reacts",defaultMessage:"Emoji reacts"},statuses:{id:"notifications.filter.statuses",defaultMessage:"Updates from people you follow"}}),De=function(){var t=K(),d=te(),s=ae(),i=ce(),m=s.getIn(["notifications","quickFilter","active"]),c=s.getIn(["notifications","quickFilter","advanced"]),a=function(u){return function(){return d(de(u))}},o=[{text:t.formatMessage(f.all),action:a("all"),name:"all"}];return c?(o.push({text:e(y,{src:ie}),title:t.formatMessage(f.mentions),action:a("mention"),name:"mention"}),o.push({text:e(y,{src:Y}),title:t.formatMessage(f.favourites),action:a("favourite"),name:"favourite"}),i.emojiReacts&&o.push({text:e(y,{src:Le}),title:t.formatMessage(f.emoji_reacts),action:a("pleroma:emoji_reaction"),name:"pleroma:emoji_reaction"}),o.push({text:e(y,{src:G}),title:t.formatMessage(f.boosts),action:a("reblog"),name:"reblog"}),o.push({text:e(y,{src:oe}),title:t.formatMessage(f.polls),action:a("poll"),name:"poll"}),o.push({text:e(y,{src:ne}),title:t.formatMessage(f.statuses),action:a("status"),name:"status"}),o.push({text:e(y,{src:D}),title:t.formatMessage(f.follows),action:a("follow"),name:"follow"})):o.push({text:t.formatMessage(f.mentions),action:a("mention"),name:"mention"}),e(ue,{items:o,activeItem:m})};const Te="/packs/assets/calendar-time-e551770b.svg";var Ue=function(t,d,s){var i=[d];return i.push(t.formatDate(s,{hour:"2-digit",minute:"2-digit",month:"short",day:"numeric"})),i.join(", ")},ze=function(t){return e("bdi",{},void 0,e(pe,{className:"font-bold text-gray-800 hover:underline dark:text-gray-200",title:t.acct,to:"/@".concat(t.acct),dangerouslySetInnerHTML:{__html:t.display_name_html}}))},Ee={follow:D,follow_request:D,mention:ie,favourite:Y,group_favourite:Y,reblog:G,group_reblog:G,status:ne,poll:oe,move:ye,"pleroma:chat_mention":be,"pleroma:emoji_reaction":we,user_approved:D,update:Ne,"pleroma:event_reminder":Te,"pleroma:participation_request":J,"pleroma:participation_accepted":J},Ae=ge({id:"notification.name",defaultMessage:"{link}{others}"}),se=O({follow:{id:"notification.follow",defaultMessage:"{name} followed you"},follow_request:{id:"notification.follow_request",defaultMessage:"{name} has requested to follow you"},mention:{id:"notification.mentioned",defaultMessage:"{name} mentioned you"},favourite:{id:"notification.favourite",defaultMessage:"{name} liked your post"},group_favourite:{id:"notification.group_favourite",defaultMessage:"{name} liked your group post"},reblog:{id:"notification.reblog",defaultMessage:"{name} reposted your post"},group_reblog:{id:"notification.group_reblog",defaultMessage:"{name} reposted your group post"},status:{id:"notification.status",defaultMessage:"{name} just posted"},poll:{id:"notification.poll",defaultMessage:"A poll you have voted in has ended"},move:{id:"notification.move",defaultMessage:"{name} moved to {targetName}"},"pleroma:chat_mention":{id:"notification.pleroma:chat_mention",defaultMessage:"{name} sent you a message"},"pleroma:emoji_reaction":{id:"notification.pleroma:emoji_reaction",defaultMessage:"{name} reacted to your post"},user_approved:{id:"notification.user_approved",defaultMessage:"Welcome to {instance}!"},update:{id:"notification.update",defaultMessage:"{name} edited a post you interacted with"},"pleroma:event_reminder":{id:"notification.pleroma:event_reminder",defaultMessage:"An event you are participating in starts soon"},"pleroma:participation_request":{id:"notification.pleroma:participation_request",defaultMessage:"{name} wants to join your event"},"pleroma:participation_accepted":{id:"notification.pleroma:participation_accepted",defaultMessage:"You were accepted to join the event"}}),Be=function(t,d,s,i,m,c){var a=ze(s),o=t.formatMessage(Ae,{link:a,others:i&&i>0?e(Q,{id:"notification.others",defaultMessage:" + {count, plural, one {# other} other {# others}}",values:{count:i-1}}):""});return t.formatMessage(se[d],{name:o,targetName:m,instance:c})},F=48,$e=function(t){var d=t.hidden,s=d===void 0?!1:d,i=t.onMoveUp,m=t.onMoveDown,c=h.useCallback(fe(),[]),a=k(function(v){return c(v,t.notification)}),o=K(),j=me(),u=a.type,r=a.account,_=a.status,I=function(){i&&i(a.id)},C=function(){m&&m(a.id)},N=function(){return u==="pleroma:emoji_reaction"&&a.emoji?e(he,{emoji:a.emoji,src:a.emoji_url||void 0,className:"h-4 w-4 flex-none"}):A(u)?e(_e,{src:Ee[u],size:16,className:"flex-none text-primary-600 dark:text-primary-400"}):null},T=function(){switch(u){case"follow":case"user_approved":return{type:0,content:r&&g(r)==="object"?e(B,{id:r.id,hidden:s,avatarSize:F,withRelationship:!0}):null};case"follow_request":return{type:0,content:r&&g(r)==="object"?e(B,{id:r.id,hidden:s,avatarSize:F,actionType:"follow_request",withRelationship:!0}):null};case"move":return{type:0,content:r&&g(r)==="object"&&a.target&&g(a.target)==="object"?e(B,{id:a.target.id,hidden:s,avatarSize:F,withRelationship:!0}):null};case"favourite":case"group_favourite":case"mention":case"reblog":case"group_reblog":case"status":case"poll":case"update":case"pleroma:emoji_reaction":case"pleroma:event_reminder":case"pleroma:participation_accepted":case"pleroma:participation_request":return{type:1,content:_&&g(_)==="object"?e(Me,{status:_,hidden:s,onMoveDown:C,onMoveUp:I,avatarSize:F,showGroup:!1,notification:{icon:N(),text:q}}):null};default:return{type:-1,content:null}}},P=a.target&&g(a.target)==="object"?a.target.acct:"",q=A(u)&&r&&g(r)==="object"?Be(o,u,r,a.total_count,P,j.title):null,L=A(u)?Ue(o,o.formatMessage(se[u],{name:r&&g(r)==="object"?r.acct:"",targetName:P}),a.created_at):"",U=function(){var p=T(),z=p.type,x=p.content;return R.createElement(R.Fragment,null,x!==null&&z!==1&&e("div",{className:"mb-2"},void 0,e(ee,{alignItems:"center",space:3},void 0,e("div",{className:"flex justify-end"},void 0,N()),e("div",{className:"truncate"},void 0,e(ve,{theme:"muted",size:"xs",truncate:!0,"data-testid":"message"},void 0,q)))),x!==null&&e("div",{},void 0,x))};return e("div",{className:"notification focusable",tabIndex:0,"aria-label":L},void 0,e("div",{className:"focusable p-4"},void 0,U()))},Z=O({title:{id:"column.notifications",defaultMessage:"Notifications"},queue:{id:"notifications.queue_label",defaultMessage:"Click to see {count} new {count, plural, one {notification} other {notifications}}"}}),He=qe([function(l){return $(l).getIn(["notifications","quickFilter","show"])},function(l){return $(l).getIn(["notifications","quickFilter","active"])},function(l){return xe($(l).getIn(["notifications","shows"]).filter(function(t){return!t}).keys())},function(l){return l.notifications.items.toList()}],function(l,t,d,s){return!l||t==="all"?s.filterNot(function(i){return i!==null&&d.includes(i.get("type"))}):s.filter(function(i){return i!==null&&t===i.get("type")})}),Je=function(){var t=te(),d=K(),s=ae(),i=s.getIn(["notifications","quickFilter","show"]),m=s.getIn(["notifications","quickFilter","active"]),c=k(function(n){return He(n)}),a=k(function(n){return n.notifications.isLoading}),o=k(function(n){return n.notifications.hasMore}),j=k(function(n){return n.notifications.totalQueuedNotificationsCount||0}),u=h.useRef(null),r=h.useRef(null),_=h.useRef(null),I=h.useCallback(H(function(){var n=c.last();t(X({maxId:n&&n.get("id")}))},300,{leading:!0}),[c]),C=h.useCallback(H(function(){t(S(!0))},100),[]),N=h.useCallback(H(function(){t(S(!1))},100),[]),T=function(b){var M=c.findIndex(function(w){return w!==null&&w.get("id")===b})-1;q(M)},P=function(b){var M=c.findIndex(function(w){return w!==null&&w.get("id")===b})+1;q(M)},q=function(b){var M;(M=u.current)===null||M===void 0||M.scrollIntoView({index:b,behavior:"smooth",done:function(){var E=r.current,V=E==null?void 0:E.querySelector('[data-index="'.concat(b,'"] .focusable'));V&&V.focus()}})},L=function(){t(je())},U=function(){return t(X())};h.useEffect(function(){return L(),t(S(!0)),function(){I.cancel(),C.cancel(),N.cancel(),t(S(!1))}},[]);var v=m==="all"?e(Q,{id:"empty_column.notifications",defaultMessage:"You don't have any notifications yet. Interact with others to start the conversation."}):e(Q,{id:"empty_column.notifications_filtered",defaultMessage:"You don't have any notifications of this type yet."}),p=null,z=i?e(De,{}):null;a&&_.current?p=_.current:c.size>0||o?p=c.map(function(n){return e($e,{notification:n,onMoveUp:T,onMoveDown:P},n.id)}):p=null,_.current=p;var x=R.createElement(Pe,{ref:u,scrollKey:"notifications",isLoading:a,showLoading:a&&c.size===0,hasMore:o,emptyMessage:v,placeholderComponent:Fe,placeholderCount:20,onLoadMore:I,onScrollToTop:C,onScroll:N,className:ke({"divide-y divide-gray-200 dark:divide-primary-800 divide-solid":c.size>0,"space-y-2":c.size===0})},p);return R.createElement(Re,{ref:r,label:d.formatMessage(Z.title),withHeader:!1},z,e(Ce,{onClick:L,count:j,message:Z.queue}),e(Ie,{onRefresh:U},void 0,x))};export{Je as default};
