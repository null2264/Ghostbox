import{R as n,a7 as ee,f as te,r as i,a as o,aB as O,Q as re,as as W,av as k,a$ as ne}from"../index-dcd449aa.js";import{V as ae}from"./index-b69eb56b.js";import{L as oe}from"./load-more-0b86834b.js";var se=["context"],le=["context"],ie=function(s){var r=s.context,l=W(s,se);return n.createElement("div",k({className:r==null?void 0:r.itemClassName},l))},de=n.forwardRef(function(e,s){var r=e.context,l=W(e,le);return n.createElement("div",k({ref:s,className:r==null?void 0:r.listClassName},l))}),ve=n.forwardRef(function(e,s){var r=e.scrollKey,l=e.prepend,C=l===void 0?null:l,D=e.alwaysPrepend,F=e.children,u=e.isLoading,I=e.emptyMessage,E=e.emptyMessageCard,H=E===void 0?!0:E,h=e.showLoading;e.onRefresh;var R=e.onScroll,K=e.onScrollToTop,m=e.onLoadMore,L=e.className,A=e.itemClassName,B=e.id,v=e.hasMore,d=e.placeholderComponent,N=e.placeholderCount,w=N===void 0?0:N,P=e.initialTopMostItemIndex,g=P===void 0?0:P,T=e.style,J=T===void 0?{}:T,$=e.useWindowScroll,V=$===void 0?!0:$,j=ee(),q=te(),p=q.get("autoloadMore"),f="soapbox:scrollData:".concat(r),a=i.useMemo(function(){return JSON.parse(sessionStorage.getItem(f))},[f]),x=i.useRef(a?a.index:0),y=i.useRef(a?a.offset:0),z=Array.from(F||[]),b=h&&d&&w>0,S=b?Array(w).fill(""):z;v&&(p||u)&&d?S.push(o(d,{})):v&&(p||u)&&S.push(o(O,{}));var M=i.useCallback(re(function(){var t=document.querySelector('[data-virtuoso-scroller] [data-item-index="'.concat(x.current,'"]'));t?y.current=t.getBoundingClientRect().top*-1:y.current=0},150,{trailing:!0}),[]);i.useEffect(function(){return document.addEventListener("scroll",M),sessionStorage.removeItem(f),function(){if(r){var t={index:x.current,offset:y.current};sessionStorage.setItem(f,JSON.stringify(t))}document.removeEventListener("scroll",M)}},[]);var Q=function(){return o("div",{className:"mt-2"},void 0,D&&C,u?o(O,{}):n.createElement(n.Fragment,null,H?o(ne,{variant:"rounded",size:"lg"},void 0,I):I))},G=function(c,_){return b?o(d,{}):_},U=function(){p&&v&&m&&m()},X=function(){return p||!v||!m?null:o(oe,{visible:!u,onClick:m})},Y=function(c){x.current=Math.min(c.startIndex+1,c.endIndex),M()},Z=i.useMemo(function(){return h?0:g||(a&&j.action==="POP"?{align:"start",index:a.index,offset:a.offset}:0)},[h,g]);return n.createElement(ae,{ref:s,id:B,useWindowScroll:V,className:L,data:S,startReached:K,endReached:U,isScrolling:function(c){return c&&R&&R()},itemContent:G,initialTopMostItemIndex:Z,rangeChanged:Y,style:J,context:{listClassName:L,itemClassName:A},components:{Header:function(){return n.createElement(n.Fragment,null,C)},ScrollSeekPlaceholder:d,EmptyPlaceholder:function(){return Q()},List:de,Item:ie,Footer:X}})});export{ve as S};
