import{R as n,a9 as ee,f as te,r as i,a as o,aF as F,Q as re,aw as O,az as W,a2 as ne}from"../index-7b6dea3f.js";import{V as ae}from"./index-eb1d5dbf.js";import{L as oe}from"./load-more-3d2f8230.js";var se=["context"],le=["context"],ie=function(s){var r=s.context,l=O(s,se);return n.createElement("div",W({className:r==null?void 0:r.itemClassName},l))},de=n.forwardRef(function(e,s){var r=e.context,l=O(e,le);return n.createElement("div",W({ref:s,className:r==null?void 0:r.listClassName},l))}),ve=n.forwardRef(function(e,s){var r=e.scrollKey,l=e.prepend,C=l===void 0?null:l,k=e.alwaysPrepend,D=e.children,u=e.isLoading,I=e.emptyMessage,E=e.emptyMessageCard,H=E===void 0?!0:E,h=e.showLoading;e.onRefresh;var R=e.onScroll,K=e.onScrollToTop,m=e.onLoadMore,w=e.className,z=e.itemClassName,A=e.id,v=e.hasMore,d=e.placeholderComponent,L=e.placeholderCount,N=L===void 0?0:L,P=e.initialTopMostItemIndex,g=P===void 0?0:P,T=e.style,J=T===void 0?{}:T,b=e.useWindowScroll,V=b===void 0?!0:b,j=ee(),q=te(),p=q.get("autoloadMore"),f="soapbox:scrollData:".concat(r),a=i.useMemo(function(){return JSON.parse(sessionStorage.getItem(f))},[f]),x=i.useRef(a?a.index:0),y=i.useRef(a?a.offset:0),B=Array.from(D||[]),$=h&&d&&N>0,S=$?Array(N).fill(""):B;v&&(p||u)&&d?S.push(o(d,{})):v&&(p||u)&&S.push(o(F,{}));var M=i.useCallback(re(function(){var t=document.querySelector('[data-virtuoso-scroller] [data-item-index="'.concat(x.current,'"]'));t?y.current=t.getBoundingClientRect().top*-1:y.current=0},150,{trailing:!0}),[]);i.useEffect(function(){return document.addEventListener("scroll",M),sessionStorage.removeItem(f),function(){if(r){var t={index:x.current,offset:y.current};sessionStorage.setItem(f,JSON.stringify(t))}document.removeEventListener("scroll",M)}},[]);var Q=function(){return o("div",{className:"mt-2"},void 0,k&&C,u?o(F,{}):n.createElement(n.Fragment,null,H?o(ne,{variant:"rounded",size:"lg"},void 0,I):I))},G=function(c,_){return $?o(d,{}):_},U=function(){p&&v&&m&&m()},X=function(){return p||!v||!m?null:o(oe,{visible:!u,onClick:m})},Y=function(c){x.current=Math.min(c.startIndex+1,c.endIndex),M()},Z=i.useMemo(function(){return h?0:g||(a&&j.action==="POP"?{align:"start",index:a.index,offset:a.offset}:0)},[h,g]);return n.createElement(ae,{ref:s,id:A,useWindowScroll:V,className:w,data:S,startReached:K,endReached:U,isScrolling:function(c){return c&&R&&R()},itemContent:G,initialTopMostItemIndex:Z,rangeChanged:Y,style:J,context:{listClassName:w,itemClassName:z},components:{Header:function(){return n.createElement(n.Fragment,null,C)},ScrollSeekPlaceholder:d,EmptyPlaceholder:function(){return Q()},List:de,Item:ie,Footer:X}})});export{ve as S};
